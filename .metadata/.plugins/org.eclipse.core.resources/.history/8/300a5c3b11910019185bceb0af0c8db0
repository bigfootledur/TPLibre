package edu.tplibre.magasin;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Map;
import java.util.Observable;

import edu.tplibre.api.Client;
import edu.tplibre.api.MagasinCommande;
import edu.tplibre.api.Produit;
import edu.tplibre.api.ProduitCommande;

public class Magasin extends Observable implements MagasinCommande{
	private Collection<Produit> catalogue;
	private Collection<Client> clients;
	
	public Magasin(){
		System.out.println("Hello world");
		catalogue = new ArrayList<Produit>();
		catalogue.add(new Produit(1, "cacao", 4.5f, 59));
		catalogue.add(new Produit(2, "lait", 10.3f, 48));
		
		clients = new ArrayList<Client>();
	}
	
	@Override
	public Collection<Produit> getCatalogue(){
		return catalogue;
	}
	
	public void setClients(Client client, Map<String, ?> ref){
		this.clients.add(client);
		passerCommande(client.getCommande(catalogue));
	}
	
	public void unsetClients(Client client){
		this.clients.remove(client);
	}

	@Override
	public void passerCommande(Collection<ProduitCommande> commande) {
		System.out.println("Commande passée");
		catalogue.iterator().next().setQuantiteDisponible(10);
		this.setChanged();
		this.notifyObservers(catalogue);
	}
}
